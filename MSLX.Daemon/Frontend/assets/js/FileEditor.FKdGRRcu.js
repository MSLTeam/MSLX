import{T as F}from"./vue-codemirror.am87IH_v.js";import{l as S,o as V,f as B,w as E,a_ as T,a$ as i,aZ as k,aU as D,aY as o,j as u,J as L,b2 as h,G as b,r as x,c as U,bi as $,av as z,bj as H,bk as K,bl as W,bm as A,bn as G,bo as I,bp as J}from"./index.DuVfB4dr.js";import{H as O,w as P,_ as Q,K as w,T as y,C as R}from"./prettier._FpaQKPv.js";import{M as f}from"./tdesign-vue-next.DXysdKln.js";import{_ as Y}from"./index.BBb2Hw3e.js";const Z={class:"editor-container"},q={class:"editor-status-bar"},X={class:"mode-tag"},ee={class:"dialog-footer"},se={class:"footer-left"},te={class:"footer-right"},ae=S({__name:"FileEditor",props:{visible:Boolean,fileName:String,content:String,loading:Boolean},emits:["update:visible","save"],setup(m,{emit:C}){const r=m,v=C,j=async()=>{var n,c;if(!a.value)return;const e=(c=(n=r.fileName)==null?void 0:n.split(".").pop())==null?void 0:c.toLowerCase();let s="",t=[];switch(e){case"json":s="json",t=[w,y];break;case"yml":case"yaml":s="yaml",t=[R];break;case"js":case"ts":s="babel",t=[w,y];break;case"css":case"less":case"scss":s="css",t=[Q];break;case"html":case"xml":s="html",t=[P];break;default:f.warning("该文件类型暂不支持自动格式化");return}try{const d=await O.format(a.value,{parser:s,plugins:t,tabWidth:2,printWidth:80,semi:!0,singleQuote:!0});a.value=d,f.success("格式化成功")}catch(d){console.error(d),f.error(`格式化失败: 请检查语法错误
${d.message.split(`
`)[0]}`)}},a=x(""),p=x(!1);let l=null;const g=()=>{const e=document.documentElement.getAttribute("theme-mode");p.value=e==="dark"};V(()=>{g(),l=new MutationObserver(g),l.observe(document.documentElement,{attributes:!0,attributeFilter:["theme-mode"]})}),B(()=>{l==null||l.disconnect()}),E(()=>r.content,e=>{a.value=e||""},{immediate:!0});const N=U(()=>{var t,n;const e=[];switch(p.value&&e.push($),e.push(z.phrases.of({Find:"查找内容...",Replace:"替换为...",next:"下一个",previous:"上一个",all:"选中所有","match case":"区分大小写","by word":"全字匹配",regexp:"正则表达式",replace:"替换","replace all":"替换全部",close:"关闭"})),(n=(t=r.fileName)==null?void 0:t.split(".").pop())==null?void 0:n.toLowerCase()){case"json":e.push(J());break;case"yml":case"yaml":e.push(I());break;case"js":case"ts":e.push(G());break;case"css":case"less":case"scss":e.push(A());break;case"html":case"xml":e.push(W());break;case"toml":case"ini":case"conf":e.push(H.define(K));break}return e}),_=()=>{v("update:visible",!1)},M=()=>{v("save",a.value)};return(e,s)=>{const t=k("t-button"),n=k("t-dialog");return D(),T(n,{visible:m.visible,header:`正在编辑: ${m.fileName}`,width:"90%",attach:"body",top:"1vh",class:"editor-dialog",onClose:_},{footer:i(()=>[o("div",ee,[o("div",se,[u(t,{variant:"outline",theme:"default",onClick:j},{default:i(()=>[...s[1]||(s[1]=[b(" 自动格式化 ",-1)])]),_:1})]),o("div",te,[u(t,{variant:"outline",onClick:_},{default:i(()=>[...s[2]||(s[2]=[b("取消",-1)])]),_:1}),u(t,{theme:"primary",loading:r.loading,onClick:M},{default:i(()=>[...s[3]||(s[3]=[b(" 保存 ",-1)])]),_:1},8,["loading"])])])]),default:i(()=>[o("div",Z,[u(L(F),{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=c=>a.value=c),placeholder:"文件内容为空...",style:{height:"70vh",fontSize:"14px"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:N.value},null,8,["modelValue","extensions"])]),o("div",q,[o("span",null,"行数: "+h(a.value.split(`
`).length),1),o("span",null,"长度: "+h(a.value.length),1),o("span",X,h(p.value?"Dark Mode":"Light Mode"),1)])]),_:1},8,["visible","header"])}}}),ce=Y(ae,[["__scopeId","data-v-8c0385d1"]]);export{ce as F};
