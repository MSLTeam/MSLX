import{u as j,a as Y}from"./vue-router.CTuarHf7.js";import{u as G,r as H,_ as C,T as K}from"./index.DqIOwG5d.js";import{M as S,N as O}from"./tdesign-vue-next.CZ9kjS-B.js";import{D as V,F as _,W,K as A,R as $,b0 as n,aX as h,aY as w,G as o,b2 as a,a$ as t,b1 as J,b6 as Q,ao as r,b5 as Z,ap as L}from"./index.BbdIPky0.js";import{L as ee}from"./Header.DZNAk6A_.js";import{a3 as te,a4 as oe,a5 as se}from"./tdesign-icons-vue-next.H9a-SwwU.js";import"./pinia.DE9DXmFR.js";import"./pinia-plugin-persistedstate_561243483b11dd07f5acf9e797fda690.n2tMOXAx.js";import"./tvision-color.BU_YHHaJ.js";import"./chroma-js.Cmk4elvR.js";import"./bezier-easing.jp9ayU57.js";import"./lodash.B5_zCkFd.js";import"./axios.R-lXtGyY.js";import"./qs.BQOswwC-.js";import"./side-channel.B7VpeXu7.js";import"./es-errors.CFxpeikN.js";import"./object-inspect.CD-SYzlK.js";import"./cron-parser.BqMfRICj.js";import"./luxon.BVaPVz1w.js";import"./side-channel-list.CQN2BsdT.js";import"./side-channel-map.mJjiYxsE.js";import"./get-intrinsic.DZF4l_-S.js";import"./es-object-atoms.Ditt1eQ6.js";import"./math-intrinsics.Cv-yPkyD.js";import"./gopd.fcd2-aIC.js";import"./es-define-property.bDCdrV83.js";import"./has-symbols.BaUvM3gb.js";import"./get-proto.GRuZvLsk.js";import"./dunder-proto.BfGlLUzx.js";import"./call-bind-apply-helpers.DPbVMkjK.js";import"./function-bind.CHqF18-c.js";import"./hasown.B1sN64jK.js";import"./call-bound.DTRAK3sj.js";import"./side-channel-weakmap.C4d6frlU.js";import"./nprogress.CMq2Rk2a.js";import"./core-js-pure.DghWRT_o.js";import"./crelt.C8TCjufn.js";import"./style-mod.Bc2inJdb.js";import"./w3c-keyname.Vcq4gwWv.js";import"./lodash-es.ClUTdtmA.js";import"./mitt.DJ65BbbF.js";import"./sortablejs.C83syoBY.js";const ae={key:0,class:"loading-wrapper"},le={key:1,class:"input-group"},ne={class:"check-container"},re={class:"btn-wrapper"},ie={class:"msl-login-wrapper"},de={class:"reset-guide"},ue={class:"guide-item"},me={class:"guide-title"},ce={class:"guide-item"},pe={class:"guide-title"},ge="remembered_url",M="remembered_username",_e=V({__name:"Login",setup(U){const u=G(),k=j(),f=Y(),s=_(!1),c=_(!1),p=_(!1),v=_(!0),b=_(!1),l=W({url:localStorage.getItem(ge)||"",username:localStorage.getItem(M)||"",password:"",checked:!!localStorage.getItem(M)}),R=_(),I=A(()=>{const i={username:[{required:!0,message:"è¯·è¾“å…¥ç”¨æˆ·å",type:"error"}],password:[{required:!0,message:"è¯·è¾“å…¥å¯†ç ",type:"error"}]};return p.value||(i.url=[{required:!0,message:"è¯·è¾“å…¥æœåŠ¡å™¨åœ°å€",type:"error"}]),i}),E=async()=>{v.value=!0,await u.checkConnection("")?(p.value=!0,l.url=""):p.value=!1,v.value=!1},z=async({validateResult:i})=>{if(i===!0){s.value=!0;try{await u.login({url:p.value?"":l.url,username:l.username,password:l.password,checked:l.checked}),S.success("ç™»å½•æˆåŠŸ");const e=f.query.redirect,m=e?decodeURIComponent(e):"/dashboard/base";k.push(m),O.success({content:`æ¬¢è¿å›æ¥ï¼${u.userInfo.name}`,title:"MSLX æ§åˆ¶å°"})}catch(e){S.error(e.message||"ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥è´¦å·å¯†ç ")}finally{s.value=!1}}},D=async()=>{try{s.value=!0;const i=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);localStorage.setItem("oauth_state",i);const e=`${window.location.origin}/oauth/callback?mode=login`,m=await H.get({url:"/api/auth/oauth/url",params:{state:i,callback:e}});if(m&&m.url)window.location.href=m.url;else throw new Error(m.message||"è·å–æˆæƒåœ°å€å¤±è´¥")}catch(i){S.error(i.message||"æ— æ³•è¿æ¥åˆ°è®¤è¯æœåŠ¡å™¨"),s.value=!1}};return $(()=>{E()}),(i,e)=>{const m=n("t-loading"),g=n("t-icon"),x=n("t-input"),y=n("t-form-item"),B=n("t-checkbox"),N=n("t-link"),q=n("t-button"),P=n("t-form"),X=n("t-divider"),T=n("t-alert"),F=n("t-dialog");return w(),h("div",null,[o(P,{ref_key:"form",ref:R,class:"login-form",data:l,rules:I.value,"label-width":"0",onSubmit:z},{default:a(()=>[v.value?(w(),h("div",ae,[o(m,{text:"æ­£åœ¨è¿æ¥æœåŠ¡...",size:"small"})])):(w(),h("div",le,[p.value?Q("",!0):(w(),J(y,{key:0,name:"url"},{default:a(()=>[o(x,{modelValue:l.url,"onUpdate:modelValue":e[0]||(e[0]=d=>l.url=d),size:"large",placeholder:"æœåŠ¡å™¨åœ°å€ (å¦‚ localhost:1027)",class:"glass-input"},{"prefix-icon":a(()=>[o(g,{name:"server"})]),_:1},8,["modelValue"])]),_:1})),o(y,{name:"username"},{default:a(()=>[o(x,{modelValue:l.username,"onUpdate:modelValue":e[1]||(e[1]=d=>l.username=d),size:"large",placeholder:"è¯·è¾“å…¥ç”¨æˆ·å",class:"glass-input"},{"prefix-icon":a(()=>[o(g,{name:"user"})]),_:1},8,["modelValue"])]),_:1}),o(y,{name:"password"},{default:a(()=>[o(x,{modelValue:l.password,"onUpdate:modelValue":e[3]||(e[3]=d=>l.password=d),size:"large",type:c.value?"text":"password",placeholder:"è¯·è¾“å…¥å¯†ç ",class:"glass-input"},{"prefix-icon":a(()=>[o(g,{name:"lock-on"})]),"suffix-icon":a(()=>[o(g,{name:c.value?"browse":"browse-off",style:{cursor:"pointer"},onClick:e[2]||(e[2]=d=>c.value=!c.value)},null,8,["name"])]),_:1},8,["modelValue","type"])]),_:1})])),t("div",ne,[o(B,{modelValue:l.checked,"onUpdate:modelValue":e[4]||(e[4]=d=>l.checked=d)},{default:a(()=>[...e[7]||(e[7]=[r("è®°ä½ç”¨æˆ·å",-1)])]),_:1},8,["modelValue"]),o(N,{theme:"primary",hover:"color",onClick:e[5]||(e[5]=d=>b.value=!0)},{default:a(()=>[...e[8]||(e[8]=[r(" å¿˜è®°å¯†ç ï¼Ÿ ",-1)])]),_:1})]),o(y,{class:"btn-container"},{default:a(()=>[t("div",re,[o(q,{block:"",size:"large",type:"submit",class:"login-btn",loading:s.value},{default:a(()=>[...e[9]||(e[9]=[r(" ç™» å½• ",-1)])]),_:1},8,["loading"]),t("div",ie,[t("a",{class:"msl-link-btn",onClick:D},[o(g,{name:"user-transmit"}),e[10]||(e[10]=t("span",null,"ä½¿ç”¨ MSL è´¦æˆ·ç™»å½•",-1))])])])]),_:1})]),_:1},8,["data","rules"]),o(F,{visible:b.value,"onUpdate:visible":e[6]||(e[6]=d=>b.value=d),header:"æ‰¾å›æˆ–é‡ç½®å¯†ç ",footer:!1,width:"480px",attach:"body"},{default:a(()=>[t("div",de,[t("div",ue,[t("div",me,[o(g,{name:"user-talk"}),e[11]||(e[11]=r(" æ–¹å¼ä¸€ï¼šè”ç³»ç®¡ç†å‘˜",-1))]),e[12]||(e[12]=t("p",{class:"guide-desc"},"å¦‚æœç³»ç»Ÿä¸­å­˜åœ¨å…¶ä»–ç®¡ç†å‘˜è´¦å·ï¼Œè¯·è”ç³»å¯¹åº”äººå‘˜ååŠ©æ‚¨åœ¨åå°é‡ç½®å¯†ç ã€‚",-1))]),o(X,{dashed:"",style:{margin:"16px 0"}}),t("div",ce,[t("div",pe,[o(g,{name:"refresh"}),e[13]||(e[13]=r(" æ–¹å¼äºŒï¼šåˆå§‹åŒ–é»˜è®¤è´¦æˆ·",-1))]),e[15]||(e[15]=t("p",{class:"guide-desc"},"è‹¥æ— æ³•è”ç³»å…¶ä»–ç®¡ç†å‘˜ï¼Œè¯·åœ¨æœåŠ¡å™¨ç«¯åˆ é™¤ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š",-1)),e[16]||(e[16]=t("div",{class:"code-block"},"DaemonData/Configs/UserList.json",-1)),t("p",null,[o(T,{style:{"margin-top":"10px"}},{default:a(()=>[...e[14]||(e[14]=[r("æ“ä½œæç¤ºï¼šåˆ é™¤è¯¥æ–‡ä»¶åï¼Œè¯·",-1),t("strong",null,"é‡å¯å®ˆæŠ¤è¿›ç¨‹",-1),r("ã€‚ç³»ç»Ÿå°†è‡ªåŠ¨é‡æ–°åˆ›å»ºåŒ…å«é»˜è®¤è´¦å·å¯†ç çš„åˆå§‹æ–‡ä»¶ã€‚",-1)])]),_:1})])])])]),_:1},8,["visible"])])}}}),fe=C(_e,[["__scopeId","data-v-5dca5f61"]]),ve={class:"login-wrapper"},be={class:"login-content"},we={class:"login-container"},ke={class:"copyright"},ye={class:"welcome-content"},he={class:"account-card"},xe={class:"info-row"},Se={class:"label"},Le={class:"info-row"},Me={class:"label"},Ce={name:"LoginIndex"},Ve=V({...Ce,setup(U){const u=_(!1),k=()=>{u.value=!1;const f=new URL(window.location.href);f.searchParams.delete("initialize"),window.history.replaceState({},"",f)};return $(()=>{new URLSearchParams(window.location.search).get("initialize")==="true"&&(u.value=!0)}),(f,s)=>{const c=n("t-alert"),p=n("t-button"),v=n("t-dialog");return w(),h("div",ve,[o(ee,{class:"login-header-fixed"}),t("div",be,[t("div",we,[s[1]||(s[1]=t("div",{class:"title-container"},[t("h1",{class:"title"},"è¿æ¥åˆ° MSLX"),t("p",{class:"sub-title"},"ç½‘é¡µç®¡ç†ä¸­å¿ƒ")],-1)),o(fe),t("footer",ke,"Copyright @ 2021-"+Z(new Date().getFullYear())+" MSLTeam",1)])]),o(K,{class:"tdesign-setting-outside"}),o(v,{visible:u.value,"onUpdate:visible":s[0]||(s[0]=b=>u.value=b),footer:!1,"close-btn":!0,width:"480px",attach:"body",class:"welcome-dialog","on-close":k},{header:a(()=>[...s[2]||(s[2]=[t("div",{class:"dialog-header-row"},[t("span",{class:"emoji-icon"},"ğŸ‰"),t("span",{class:"header-text"},"æ¬¢è¿ä½¿ç”¨ MSLX å¼€æœå™¨")],-1)])]),default:a(()=>[t("div",ye,[o(c,{theme:"success",class:"security-alert"},{message:a(()=>[...s[3]||(s[3]=[r(" æ‚¨ä¼¼ä¹æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Ÿè¯·æŸ¥é˜…ä»¥ä¸‹ä¿¡æ¯ï¼Œç„¶åå¼€å§‹äº«å—æ‚¨çš„MCå¼€æœä¹‹æ—…å§ï½ ",-1)])]),_:1}),t("div",he,[t("div",xe,[t("span",Se,[o(L(te)),s[4]||(s[4]=r(" é»˜è®¤è´¦æˆ·:",-1))]),s[5]||(s[5]=t("span",{class:"value highlight"},"mslx",-1))]),t("div",Le,[t("span",Me,[o(L(oe)),s[6]||(s[6]=r(" é»˜è®¤å¯†ç :",-1))]),s[7]||(s[7]=t("span",{class:"value mono"},"è¯·åœ¨MSLXå®ˆæŠ¤è¿›ç¨‹ç«¯æ§åˆ¶å°æŸ¥çœ‹",-1))])]),o(c,{theme:"warning",class:"security-alert"},{message:a(()=>[...s[8]||(s[8]=[r(" å®‰å…¨æé†’ï¼šè¯·ç™»å½•å",-1),t("b",null,[t("u",null,"ç«‹å³ä¿®æ”¹é»˜è®¤çš„è´¦æˆ·åå’Œå¯†ç ")],-1),r("ï¼Œä¿éšœæ‚¨çš„æœåŠ¡å®‰å…¨ã€‚ ",-1)])]),_:1}),o(p,{block:"",theme:"primary",size:"large",variant:"base",onClick:k},{icon:a(()=>[o(L(se))]),default:a(()=>[s[9]||(s[9]=r(" æˆ‘å·²çŸ¥æ™“ï¼Œç«‹å³ç™»å½• ",-1))]),_:1})])]),_:1},8,["visible"])])}}}),vt=C(Ve,[["__scopeId","data-v-59aa3632"]]);export{vt as default};
