import{u as C,r as E,_ as T,e as I,c as q}from"./index.DKJwv0BD.js";import{I as f,C as M,T as z,a as H,L as J}from"./tdesign-vue-next.Csn1Y9JM.js";import{l as $,o as V,aU as g,a_ as b,a$ as c,aY as e,J as t,j as o,G as U,b2 as d,r as h,n as j,f as Y,aZ as k,aV as P,k as Z,b7 as K,ba as Q,w as W,b3 as X,c as ee}from"./index.DuVfB4dr.js";import{u as te}from"./instance.B_DGuZKN.js";import{i as D}from"./echarts.DjUoIeYL.js";import{V as se}from"./zrender.CtWC8fqq.js";import{a as oe}from"./md-editor-v3.CoCwYQ4W.js";import"./pinia.K9HejpEf.js";import"./pinia-plugin-persistedstate_2eabddac918ad8d0cf74e67f4601f4c8.n2tMOXAx.js";import"./vue-router.BSuyFzNa.js";import"./tvision-color.Cy78gTfV.js";import"./chroma-js.DO2ptVd8.js";import"./core-js-pure.DbDavgKW.js";import"./bezier-easing.D5A5epFU.js";import"./lodash.CpoxsuHF.js";import"./axios.B9ygI19o.js";import"./qs.CsZETzAf.js";import"./side-channel.gyxQHTce.js";import"./es-errors.CFxpeikN.js";import"./object-inspect.CWmL7r7A.js";import"./side-channel-list.DZ_HK50j.js";import"./side-channel-map.Ujj6CYbr.js";import"./get-intrinsic.DZF4l_-S.js";import"./es-object-atoms.Ditt1eQ6.js";import"./math-intrinsics.Cv-yPkyD.js";import"./gopd.fcd2-aIC.js";import"./es-define-property.bDCdrV83.js";import"./has-symbols.BaUvM3gb.js";import"./get-proto.GRuZvLsk.js";import"./dunder-proto.BfGlLUzx.js";import"./call-bind-apply-helpers.DPbVMkjK.js";import"./function-bind.CHqF18-c.js";import"./hasown.B1sN64jK.js";import"./call-bound.DTRAK3sj.js";import"./side-channel-weakmap.D0YmY7JX.js";import"./nprogress.COlaCQ7y.js";import"./tdesign-icons-vue-next.BalHEYKK.js";import"./crelt.C8TCjufn.js";import"./style-mod.Bc2inJdb.js";import"./w3c-keyname.Vcq4gwWv.js";import"./lodash-es.sbUBen0f.js";import"./mitt.DJ65BbbF.js";import"./sortablejs.C83syoBY.js";import"./tslib.BDyQ-Jie.js";import"./markdown-it.Baj76ayU.js";import"./mdurl.k9Sl0PQj.js";import"./uc.micro.kMc2yuuw.js";import"./entities.C20TfXL6.js";import"./linkify-it.DWYhiEiT.js";import"./punycode.js.Dj65hjkv.js";import"./markdown-it-image-figures.IpqUZCLv.js";import"./markdown-it-sub.Bxi31R0z.js";import"./markdown-it-sup.Bp2DoVCN.js";import"./lru-cache.aBL3gNlE.js";import"./medium-zoom.bWEtUbjf.js";const ne={class:"welcome-header"},ae={class:"avatar-section"},ie=["src"],re={class:"welcome-info"},le={class:"welcome-text"},ce={class:"hitokoto-text"},me=$({__name:"Banner",setup(S){const a=C(),n=h("");async function u(){const s=`Every little creature in the world has their own piece of paradise.
Plants take root in the boundless earth, and their leaves grow toward the stars.`;try{const l=await E.get({url:"/?c=a&c=b&c=c&c=d",baseURL:"https://v1.hitokoto.cn"});l&&l.hitokoto?n.value=`${l.hitokoto} â€”â€” ã€Š${l.from}ã€‹${l.from_who?` (${l.from_who})`:""}`:n.value=s}catch(l){n.value=s,console.error("è·å–ä¸€è¨€(Hitokoto)å¤±è´¥:",l)}}return V(()=>{u()}),(s,l)=>(g(),b(t(M),{shadow:"",bordered:!1,class:"welcome-card"},{default:c(()=>[e("div",ne,[e("div",ae,[e("img",{src:t(a).userInfo.avatar,alt:"å¤´åƒ",class:"user-avatar"},null,8,ie)]),e("div",re,[e("h3",le,[o(t(f),{name:"sunny",class:"welcome-icon"}),U(" ä½ å¥½, "+d(t(a).userInfo.name),1)]),e("p",ce,d(n.value),1)])])]),_:1}))}}),de=T(me,[["__scopeId","data-v-bfba57a3"]]),ue={class:"info-grid"},pe={class:"info-item"},_e={class:"info-label"},fe={class:"info-value"},ve={class:"info-item"},he={class:"info-label"},ge={class:"info-value"},ye={class:"info-item"},we={class:"info-label"},be={class:"info-value truncate-value"},xe={class:"info-item"},ke={class:"info-label"},$e={class:"info-value truncate-value"},Se={class:"info-item"},Ie={class:"info-label"},Ue={class:"info-value truncate-value"},Ce={class:"info-item"},Te={class:"info-label"},Ve={class:"info-value"},Le={class:"info-item"},Re={class:"info-label"},ze={class:"info-value truncate-value"},Me={class:"info-item"},Ae={class:"info-label"},Be={class:"info-value"},Ne=$({__name:"InfoCard",setup(S){const a=C(),n=te();return V(()=>{n.refreshInstanceList()}),(u,s)=>(g(),b(t(M),{shadow:"",bordered:!1,class:"system-info-card"},{default:c(()=>[e("div",ue,[e("div",pe,[e("span",_e,[o(t(f),{name:"server"}),s[0]||(s[0]=e("span",null,"åœ¨çº¿å®ä¾‹ï¼š",-1))]),e("span",fe,d(t(n).onlineInstanceCount)+" / "+d(t(n).totalInstanceCount),1)]),e("div",ve,[e("span",he,[o(t(f),{name:"logo-codepen"}),s[1]||(s[1]=e("span",null,"NETç¯å¢ƒï¼š",-1))]),e("span",ge,d(t(a).userInfo.systemInfo.netVersion),1)]),e("div",ye,[e("span",we,[o(t(f),{name:"dashboard"}),s[2]||(s[2]=e("span",null,"é¢æ¿ç‰ˆæœ¬ï¼š",-1))]),o(t(z),{content:t(I).version,"max-width":"400px"},{default:c(()=>[e("span",be,d(t(I).version),1)]),_:1},8,["content"])]),e("div",xe,[e("span",ke,[o(t(f),{name:"cloud"}),s[3]||(s[3]=e("span",null,"èŠ‚ç‚¹ç‰ˆæœ¬ï¼š",-1))]),o(t(z),{content:`v${t(a).userInfo.version}`,"max-width":"400px"},{default:c(()=>[e("span",$e," v"+d(t(a).userInfo.version),1)]),_:1},8,["content"])]),e("div",Se,[e("span",Ie,[o(t(f),{name:"desktop"}),s[4]||(s[4]=e("span",null,"ä¸»æœºåï¼š",-1))]),e("span",Ue,d(t(a).userInfo.systemInfo.hostname),1)]),e("div",Ce,[e("span",Te,[o(t(f),{name:"system-code"}),s[5]||(s[5]=e("span",null,"ç³»ç»Ÿç±»å‹ï¼š",-1))]),e("span",Ve,d(t(a).userInfo.systemInfo.osType)+" ("+d(t(a).userInfo.systemInfo.osArchitecture)+")",1)]),e("div",Le,[e("span",Re,[o(t(f),{name:"system-setting"}),s[6]||(s[6]=e("span",null,"ç³»ç»Ÿç‰ˆæœ¬ï¼š",-1))]),o(t(z),{content:t(a).userInfo.systemInfo.osVersion,"max-width":"400px"},{default:c(()=>[e("span",ze,d(t(a).userInfo.systemInfo.osVersion),1)]),_:1},8,["content"])]),e("div",Me,[e("span",Ae,[o(t(f),{name:"check-circle"}),s[7]||(s[7]=e("span",null,"ç‰ˆæœ¬åŒ¹é…ï¼š",-1))]),e("span",Be,[o(t(H),{theme:t(a).userInfo.targetFrontendVersion.panel===t(I).version?"success":"danger",variant:"light"},{default:c(()=>[U(d(t(a).userInfo.targetFrontendVersion.panel===t(I).version?"æ­£ç¡®åŒ¹é…":"è¯·æ›´æ–°"),1)]),_:1},8,["theme"])])])])]),_:1}))}}),De=T(Ne,[["__scopeId","data-v-e21be5b0"]]),Ee={class:"monitor-dashboard"},Pe={class:"card-content"},Oe={class:"info-section"},Fe={class:"value-group"},Ge={class:"value"},qe={class:"card-content"},He={class:"info-section"},Je={class:"value-group"},je={class:"value"},Ye={class:"sub-text"},Ze=30,Ke=$({__name:"SystemStatus",setup(S){const a=C(),n=h(null),u=h(!1),s=h(null),l=h(null);let m=null,r=null;const v=Z({cpu:0,memUsage:0,memUsed:0,memTotal:0}),w=[],L=[],R=[],A=_=>getComputedStyle(document.documentElement).getPropertyValue(_).trim()||"#999999",B=(_,i,y)=>({grid:{top:10,right:10,bottom:0,left:0,containLabel:!1},tooltip:{trigger:"axis",backgroundColor:"var(--td-bg-color-container)",borderColor:"var(--td-component-border)",textStyle:{color:"var(--td-text-color-primary)"},formatter:p=>{const x=p[0];return`${x.name}<br/><span style="color:${_}">â—</span> ${i}: <b>${x.value}%</b>`}},xAxis:{type:"category",boundaryGap:!1,data:w,show:!1},yAxis:{type:"value",max:100,min:0,show:!1},series:[{name:i,type:"line",smooth:!0,showSymbol:!1,lineStyle:{width:2,color:_},areaStyle:{opacity:.2,color:new se(0,0,0,1,[{offset:0,color:_},{offset:1,color:"transparent"}])},data:y}]}),O=()=>{const _=A("--td-brand-color"),i=A("--td-success-color");s.value&&(m=D(s.value),m.setOption(B(_,"CPU",[]))),l.value&&(r=D(l.value),r.setOption(B(i,"Memory",[]))),window.addEventListener("resize",N)},N=()=>{m==null||m.resize(),r==null||r.resize()},F=async()=>{const{baseUrl:_,token:i}=a,y=new URL("/api/hubs/system",_||window.location.origin);i&&y.searchParams.append("x-user-token",i),n.value=new K().withUrl(y.toString(),{withCredentials:!1}).withAutomaticReconnect().build(),n.value.on("ReceiveSystemStats",p=>{v.cpu=p.cpu,v.memUsage=p.memUsage,v.memUsed=p.memUsed,v.memTotal=p.memTotal,w.length>=Ze&&(w.shift(),L.shift(),R.shift()),w.push(p.timestamp),L.push(p.cpu),R.push(p.memUsage),m==null||m.setOption({xAxis:{data:w},series:[{data:L}]}),r==null||r.setOption({xAxis:{data:w},series:[{data:R}]})});try{await n.value.start(),u.value=!0,await n.value.invoke("JoinMonitor")}catch(p){console.error("SignalR è¿æ¥å¤±è´¥:",p)}n.value.onclose(()=>{u.value=!1})};return V(()=>{j(()=>{setTimeout(()=>{O(),F()},100)})}),Y(async()=>{if(window.removeEventListener("resize",N),n.value)try{await n.value.invoke("LeaveMonitor"),await n.value.stop()}catch(_){console.error(_)}m==null||m.dispose(),r==null||r.dispose()}),(_,i)=>{const y=k("t-tag"),p=k("t-card"),x=k("t-col"),G=k("t-row");return g(),P("div",Ee,[o(G,{gutter:[12,12]},{default:c(()=>[o(x,{xs:12,md:6},{default:c(()=>[o(p,{shadow:"",bordered:!1,class:"chart-card",size:"small"},{default:c(()=>[e("div",Pe,[e("div",Oe,[i[3]||(i[3]=e("div",{class:"label"},"CPU ä½¿ç”¨ç‡",-1)),e("div",Fe,[e("span",Ge,d(v.cpu),1),i[0]||(i[0]=e("span",{class:"unit"},"%",-1))]),u.value?(g(),b(y,{key:0,theme:"success",variant:"light",size:"small",class:"status-tag"},{default:c(()=>[...i[1]||(i[1]=[U(" å®æ—¶ ",-1)])]),_:1})):(g(),b(y,{key:1,theme:"danger",variant:"light",size:"small",class:"status-tag"},{default:c(()=>[...i[2]||(i[2]=[U(" ç¦»çº¿ ",-1)])]),_:1}))]),e("div",{ref_key:"cpuChartRef",ref:s,class:"chart-container"},null,512)])]),_:1})]),_:1}),o(x,{xs:12,md:6},{default:c(()=>[o(p,{shadow:"",bordered:!1,class:"chart-card",size:"small"},{default:c(()=>[e("div",qe,[e("div",He,[i[5]||(i[5]=e("div",{class:"label"},"å†…å­˜ä½¿ç”¨ç‡",-1)),e("div",Je,[e("span",je,d(v.memUsage),1),i[4]||(i[4]=e("span",{class:"unit"},"%",-1))]),e("div",Ye,d((v.memUsed/1024).toFixed(1))+" / "+d((v.memTotal/1024).toFixed(1))+" GB ",1)]),e("div",{ref_key:"memChartRef",ref:l,class:"chart-container"},null,512)])]),_:1})]),_:1})]),_:1})])}}}),Qe=T(Ke,[["__scopeId","data-v-4c938660"]]),We={class:"card-header"},Xe={class:"announcement-wrapper"},et=$({__name:"Announcement",setup(S){const a=h(!0),n=h(""),u=Q(),s=h(u.value?"dark":"light");W(u,()=>{s.value=u.value?"dark":"light"});async function l(){a.value=!0;const m=`## ğŸ”´ å…¬å‘ŠåŠ è½½å¤±è´¥
- è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è”ç³»ç®¡ç†å‘˜ã€‚`;try{const r=await E.get({url:"https://api.mslmc.cn/v3/query/notice?query=mslxNoticeMd"});r&&r.mslxNoticeMd?n.value=r.mslxNoticeMd:n.value=m}catch(r){console.error("è·å–å…¬å‘Šå¤±è´¥:",r),n.value=m}finally{a.value=!1}}return V(()=>{l()}),(m,r)=>(g(),b(t(M),{shadow:"",bordered:!1,class:"announcement-card"},{title:c(()=>[e("div",We,[o(t(f),{name:"system-messages"}),r[0]||(r[0]=e("span",null,"ç³»ç»Ÿå…¬å‘Š",-1))])]),default:c(()=>[o(t(J),{loading:a.value,text:"åŠ è½½ä¸­...",size:"small",style:{width:"100%"}},{default:c(()=>[e("div",Xe,[o(t(oe),{"editor-id":"announcement-preview","model-value":n.value,theme:s.value,class:"md-preview-wrapper"},null,8,["model-value","theme"])])]),_:1},8,["loading"])]),_:1}))}}),tt=T(et,[["__scopeId","data-v-a0056e46"]]),os=$({__name:"index",setup(S){const a=C(),n=ee(()=>{var u;return((u=a.userInfo)==null?void 0:u.username)==="mslx"});return(u,s)=>{const l=k("t-alert");return g(),P("div",null,[n.value?(g(),b(l,{key:0,theme:"warning",title:"å®‰å…¨é£é™©æç¤º",message:"æ£€æµ‹åˆ°æ‚¨å½“å‰æ­£åœ¨ä½¿ç”¨é»˜è®¤è´¦å· (mslx)ã€‚ä¸ºäº†ä¿éšœç³»ç»Ÿå®‰å…¨ï¼Œè¯·åŠ¡å¿…å°½å¿«ä¿®æ”¹ç”¨æˆ·åå’Œå¯†ç ï¼",style:{"margin-bottom":"16px"}},{operation:c(()=>[e("span",{style:{cursor:"pointer"},onClick:s[0]||(s[0]=m=>t(q)("/settings"))},"å»ä¿®æ”¹")]),_:1})):X("",!0),o(de),o(De,{style:{"margin-top":"12px"}}),o(Qe,{style:{"margin-top":"12px"}}),o(tt,{style:{"margin-top":"12px"}})])}}});export{os as default};
