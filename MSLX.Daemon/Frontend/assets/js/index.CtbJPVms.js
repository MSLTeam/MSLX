import{u as T,a as z}from"./vue-router.CTuarHf7.js";import{u as D,_ as x,a as H,b as N,p as P,T as X}from"./index.DUo0lIWi.js";import{M as V}from"./tdesign-vue-next.B9R1AJJu.js";import{D as y,F as g,W as F,K as G,R as Y,b0 as n,b1 as C,aY as u,b2 as s,aX as h,a$ as a,G as e,b6 as K,ao as L,aZ as W,ap as Z,b5 as j}from"./index.BbdIPky0.js";import"./pinia.DE9DXmFR.js";import"./pinia-plugin-persistedstate.n2tMOXAx.js";import"./tvision-color.BU_YHHaJ.js";import"./chroma-js.Cmk4elvR.js";import"./bezier-easing.jp9ayU57.js";import"./lodash.B5_zCkFd.js";import"./axios.R-lXtGyY.js";import"./qs.CnepGyXr.js";import"./side-channel.Bf-JVZLg.js";import"./es-errors.CFxpeikN.js";import"./object-inspect.CD-SYzlK.js";import"./cron-parser.BqMfRICj.js";import"./luxon.BVaPVz1w.js";import"./side-channel-list.CQN2BsdT.js";import"./side-channel-map.BJ69Knz3.js";import"./get-intrinsic.CAdfHqt8.js";import"./es-object-atoms.Ditt1eQ6.js";import"./math-intrinsics.Cv-yPkyD.js";import"./gopd.fcd2-aIC.js";import"./es-define-property.bDCdrV83.js";import"./has-symbols.BaUvM3gb.js";import"./get-proto.Cbri-GHQ.js";import"./dunder-proto.q7lw_6_J.js";import"./call-bind-apply-helpers.BxcZtPLH.js";import"./function-bind.BbkWVFrm.js";import"./hasown.ckq0ukzO.js";import"./call-bound.BO70H6sD.js";import"./side-channel-weakmap.BkoVKe_V.js";import"./nprogress.CMq2Rk2a.js";import"./core-js-pure.DghWRT_o.js";import"./crelt.C8TCjufn.js";import"./style-mod.Bc2inJdb.js";import"./w3c-keyname.Vcq4gwWv.js";import"./lodash-es.ClUTdtmA.js";import"./tdesign-icons-vue-next.B3wvPiG1.js";import"./mitt.DJ65BbbF.js";import"./sortablejs.C83syoBY.js";const A={key:0,class:"loading-wrapper"},J={key:1,class:"input-group"},O={class:"check-container"},Q="remembered_url",M="remembered_username",ee=y({__name:"Login",setup(S){const p=D(),c=T(),b=z(),d=g(!1),_=g(!1),r=g(!1),i=g(!0),o=F({url:localStorage.getItem(Q)||"",username:localStorage.getItem(M)||"",password:"",checked:!!localStorage.getItem(M)}),R=g(),$=G(()=>{const m={username:[{required:!0,message:"请输入用户名",type:"error"}],password:[{required:!0,message:"请输入密码",type:"error"}]};return r.value||(m.url=[{required:!0,message:"请输入服务器地址",type:"error"}]),m}),U=async()=>{i.value=!0,await p.checkConnection("")?(r.value=!0,o.url=""):r.value=!1,i.value=!1},E=async({validateResult:m})=>{if(m===!0){d.value=!0;try{await p.login({url:r.value?"":o.url,username:o.username,password:o.password,checked:o.checked}),V.success("登录成功");const t=b.query.redirect,w=t?decodeURIComponent(t):"/dashboard/base";c.push(w)}catch(t){V.error(t.message||"登录失败，请检查账号密码")}finally{d.value=!1}}};return Y(()=>{U()}),(m,t)=>{const w=n("t-loading"),f=n("t-icon"),k=n("t-input"),v=n("t-form-item"),I=n("t-checkbox"),q=n("t-button"),B=n("t-form");return u(),C(B,{ref_key:"form",ref:R,class:"login-form",data:o,rules:$.value,"label-width":"0",onSubmit:E},{default:s(()=>[i.value?(u(),h("div",A,[e(w,{text:"正在连接服务...",size:"small"})])):(u(),h("div",J,[r.value?K("",!0):(u(),C(v,{key:0,name:"url"},{default:s(()=>[e(k,{modelValue:o.url,"onUpdate:modelValue":t[0]||(t[0]=l=>o.url=l),size:"large",placeholder:"服务器地址 (如 localhost:1027)",class:"glass-input"},{"prefix-icon":s(()=>[e(f,{name:"server"})]),_:1},8,["modelValue"])]),_:1})),e(v,{name:"username"},{default:s(()=>[e(k,{modelValue:o.username,"onUpdate:modelValue":t[1]||(t[1]=l=>o.username=l),size:"large",placeholder:"请输入用户名",class:"glass-input"},{"prefix-icon":s(()=>[e(f,{name:"user"})]),_:1},8,["modelValue"])]),_:1}),e(v,{name:"password"},{default:s(()=>[e(k,{modelValue:o.password,"onUpdate:modelValue":t[3]||(t[3]=l=>o.password=l),size:"large",type:_.value?"text":"password",placeholder:"请输入密码",class:"glass-input"},{"prefix-icon":s(()=>[e(f,{name:"lock-on"})]),"suffix-icon":s(()=>[e(f,{name:_.value?"browse":"browse-off",style:{cursor:"pointer"},onClick:t[2]||(t[2]=l=>_.value=!_.value)},null,8,["name"])]),_:1},8,["modelValue","type"])]),_:1})])),a("div",O,[e(I,{modelValue:o.checked,"onUpdate:modelValue":t[4]||(t[4]=l=>o.checked=l)},{default:s(()=>[...t[5]||(t[5]=[L("记住用户名",-1)])]),_:1},8,["modelValue"])]),e(v,{class:"btn-container"},{default:s(()=>[e(q,{block:"",size:"large",type:"submit",class:"login-btn",loading:d.value},{default:s(()=>[...t[6]||(t[6]=[L(" 登 录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["data","rules"])}}}),te=x(ee,[["__scopeId","data-v-2f80b376"]]),oe={class:"login-header"},se={class:"logo"},ae={class:"operations-container"},ne=y({__name:"Header",setup(S){const p=H(),c=()=>{p.updateConfig({showSettingPanel:!0})},b=()=>{window.open("https://github.com/MSLTeam/MSLX")},d=()=>{window.open("https://www.mslmc.cn")};return(_,r)=>{const i=n("t-icon"),o=n("t-button");return u(),h("header",oe,[a("span",se,[a("img",{src:N,class:W(`${Z(P)}-side-nav-logo-img`),alt:"logo"},null,2),r[0]||(r[0]=a("span",null," MSLX 管理中心 ",-1))]),a("div",ae,[e(o,{theme:"default",shape:"square",variant:"text",onClick:b},{default:s(()=>[e(i,{name:"logo-github",class:"icon"})]),_:1}),e(o,{theme:"default",shape:"square",variant:"text",onClick:d},{default:s(()=>[e(i,{name:"help-circle",class:"icon"})]),_:1}),e(o,{theme:"default",shape:"square",variant:"text",onClick:c},{default:s(()=>[e(i,{name:"setting",class:"icon"})]),_:1})])])}}}),re=x(ne,[["__scopeId","data-v-e76b0337"]]),le={class:"login-wrapper"},ie={class:"login-content"},ce={class:"login-container"},me={class:"copyright"},ue={name:"LoginIndex"},pe=y({...ue,setup(S){return(p,c)=>(u(),h("div",le,[e(re,{class:"login-header-fixed"}),a("div",ie,[a("div",ce,[c[0]||(c[0]=a("div",{class:"title-container"},[a("h1",{class:"title"},"连接到 MSLX"),a("p",{class:"sub-title"},"网页管理中心")],-1)),e(te),a("footer",me,"Copyright @ 2021-"+j(new Date().getFullYear())+" MSLTeam",1)])]),e(X,{class:"tdesign-setting-outside"})]))}}),et=x(pe,[["__scopeId","data-v-901f3268"]]);export{et as default};
