import{D as X,F as i,R as ke,aa as $e,P as W,K as q,b1 as R,b2 as o,b0 as w,aY as _,a$ as u,G as l,ap as z,b5 as V,bk as Ke,bl as qe,bm as Ae,bn as Ge,bo as We,bp as Xe,aX as S,ao as x,b6 as E,b3 as Ce,O as xe,am as He,b7 as Ye,bh as Ze,b4 as Je,a_ as Qe}from"./index.jXwDIiIy.js";import{a as et,u as tt}from"./vue-router.D-iQ2OF3.js";import{e as st,h as at,j as lt,k as ot,l as nt,m as it,n as _e,a as rt,o as ut,r as ct,p as dt,b as vt}from"./files.B5PWLoXT.js";import{T as mt}from"./vue-codemirror.B5OEP9N1.js";import{_ as H,d as pt}from"./index.CN3ZU4M_.js";import{F as ft}from"./FileUploader.BsUTW1H2.js";import{a as gt,e as bt,aq as ht,ar as _t,as as yt,at as wt,U as kt,au as $t,av as ye,H as Ct,ad as xt,_ as Ut,M as Pt,aw as Ft,af as It,an as we,ax as Dt,ab as Vt,ay as St,X as zt}from"./tdesign-icons-vue-next.pM9rkfXR.js";import{M as p,D as Bt}from"./tdesign-vue-next.B-7BKoqk.js";import"./core-js-pure.B3GbnEth.js";import"./crelt.C8TCjufn.js";import"./style-mod.Bc2inJdb.js";import"./w3c-keyname.Vcq4gwWv.js";import"./codemirror.C1yoHgnh.js";import"./pinia.0hRipQgY.js";import"./pinia-plugin-persistedstate.n2tMOXAx.js";import"./tvision-color.C7wwferE.js";import"./chroma-js.CkGq980d.js";import"./bezier-easing.CPMHfRa9.js";import"./lodash.iY27rsMZ.js";import"./axios.R-lXtGyY.js";import"./qs.D0saImlE.js";import"./side-channel.DWC36ANH.js";import"./es-errors.CFxpeikN.js";import"./object-inspect.B1mntT96.js";import"./cron-parser.DOnFJhWU.js";import"./luxon.BVaPVz1w.js";import"./side-channel-list.Df5Vde-x.js";import"./side-channel-map.4MBLZtF4.js";import"./get-intrinsic.CAdfHqt8.js";import"./es-object-atoms.Ditt1eQ6.js";import"./math-intrinsics.Cv-yPkyD.js";import"./gopd.fcd2-aIC.js";import"./es-define-property.bDCdrV83.js";import"./has-symbols.BaUvM3gb.js";import"./get-proto.Cbri-GHQ.js";import"./dunder-proto.q7lw_6_J.js";import"./call-bind-apply-helpers.BxcZtPLH.js";import"./function-bind.BbkWVFrm.js";import"./hasown.ckq0ukzO.js";import"./call-bound.BO70H6sD.js";import"./side-channel-weakmap.BIAXU6K3.js";import"./nprogress.Nt2Hi8cf.js";import"./lodash-es.ClUTdtmA.js";import"./mitt.DJ65BbbF.js";import"./sortablejs.C83syoBY.js";const Lt={class:"editor-container"},Rt={class:"editor-status-bar"},jt={class:"mode-tag"},Et=X({__name:"FileEditor",props:{visible:Boolean,fileName:String,content:String,loading:Boolean},emits:["update:visible","save"],setup(U,{emit:B}){const f=U,b=B,d=i(""),v=i(!1);let a=null;const n=()=>{const m=document.documentElement.getAttribute("theme-mode");v.value=m==="dark"};ke(()=>{n(),a=new MutationObserver(n),a.observe(document.documentElement,{attributes:!0,attributeFilter:["theme-mode"]})}),$e(()=>{a==null||a.disconnect()}),W(()=>f.content,m=>{d.value=m||""},{immediate:!0});const k=q(()=>{var y,r;const m=[];switch(v.value&&m.push(Ke),(r=(y=f.fileName)==null?void 0:y.split(".").pop())==null?void 0:r.toLowerCase()){case"json":m.push(Xe());break;case"yml":case"yaml":m.push(We());break;case"js":case"ts":m.push(Ge());break;case"css":case"less":case"scss":m.push(Ae());break;case"html":case"xml":m.push(qe());break}return m}),F=()=>{b("update:visible",!1)},I=()=>{b("save",d.value)};return(m,C)=>{const y=w("t-dialog");return _(),R(y,{visible:U.visible,header:`正在编辑: ${U.fileName}`,width:"90%",attach:"body",top:"1vh","confirm-btn":{content:"保存",loading:f.loading,theme:"primary"},class:"editor-dialog",onClose:F,onConfirm:I},{default:o(()=>[u("div",Lt,[l(z(mt),{modelValue:d.value,"onUpdate:modelValue":C[0]||(C[0]=r=>d.value=r),placeholder:"文件内容为空...",style:{height:"70vh",fontSize:"14px"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:k.value},null,8,["modelValue","extensions"])]),u("div",Rt,[u("span",null,"行数: "+V(d.value.split(`
`).length),1),u("span",null,"长度: "+V(d.value.length),1),u("span",jt,V(v.value?"Dark Mode":"Light Mode"),1)])]),_:1},8,["visible","header","confirm-btn"])}}}),Mt=H(Et,[["__scopeId","data-v-a91f60c0"]]),Tt={class:"image-wrapper"},Nt=["src","alt"],Ot={key:1,class:"loading-placeholder"},Kt=X({__name:"ImagePreview",props:{visible:{type:Boolean},fileName:{},imageBlobUrl:{}},emits:["update:visible"],setup(U,{emit:B}){const f=B,b=()=>{f("update:visible",!1)};return(d,v)=>{const a=w("t-dialog");return _(),R(a,{visible:U.visible,header:U.fileName,footer:!1,width:"auto",top:"10vh",class:"image-preview-dialog",onClose:b},{default:o(()=>[u("div",Tt,[U.imageBlobUrl?(_(),S("img",{key:0,src:U.imageBlobUrl,alt:U.fileName},null,8,Nt)):(_(),S("div",Ot,"加载中..."))])]),_:1},8,["visible","header"])}}}),qt=H(Kt,[["__scopeId","data-v-12b7ca8e"]]),At={key:0,class:"compress-form"},Gt={class:"file-list-preview"},Wt={class:"actions"},Xt={key:1,class:"progress-view"},Ht={class:"status-icon"},Yt={class:"status-text"},Zt=X({__name:"FileCompressor",props:{visible:{type:Boolean},instanceId:{},currentPath:{},files:{}},emits:["update:visible","success"],setup(U,{emit:B}){const f=U,b=B,d=i(""),v=i("idle"),a=i(0),n=i("");let k=null;W(()=>f.visible,y=>{y?(v.value="idle",a.value=0,n.value="",f.files.length>0&&(d.value=`${f.files[0]}_packed.zip`)):F()});const F=()=>{k&&(clearInterval(k),k=null)},I=async()=>{if(!d.value.trim()){p.warning("请输入压缩包名称");return}let y=d.value;y.endsWith(".zip")||(y+=".zip"),v.value="processing",a.value=0,n.value="正在提交任务...";try{const L=(await st(f.instanceId,f.files,y,f.currentPath)).taskId;if(L)m(L);else throw new Error("未获取到任务ID")}catch(r){v.value="error",n.value=r.message||"提交失败"}},m=y=>{k=window.setInterval(async()=>{try{const r=await at(y);a.value=r.progress,n.value=r.message,r.status==="success"?(F(),v.value="success",a.value=100,setTimeout(()=>{b("success"),b("update:visible",!1)},1e3)):r.status==="error"&&(F(),v.value="error")}catch(r){console.error(r)}},1e3)},C=()=>{v.value==="processing"&&p.warning("后台任务仍在进行中，关闭窗口不会取消任务"),F(),b("update:visible",!1)};return $e(()=>F()),(y,r)=>{const L=w("t-input"),j=w("t-button"),D=w("t-loading"),h=w("t-progress"),$=w("t-dialog");return _(),R($,{visible:U.visible,header:v.value==="idle"?"创建压缩包":"正在压缩",footer:!1,"close-on-overlay-click":!1,width:"480px",onClose:C},{default:o(()=>[v.value==="idle"?(_(),S("div",At,[u("div",Gt,[r[1]||(r[1]=x(" 即将压缩 ",-1)),u("span",null,V(U.files.length),1),r[2]||(r[2]=x(" 个文件/文件夹 ",-1))]),l(L,{modelValue:d.value,"onUpdate:modelValue":r[0]||(r[0]=A=>d.value=A),placeholder:"请输入文件名",suffix:".zip",autofocus:"",onEnter:I},null,8,["modelValue"]),u("div",Wt,[l(j,{theme:"default",variant:"text",onClick:C},{default:o(()=>[...r[3]||(r[3]=[x("取消",-1)])]),_:1}),l(j,{theme:"primary",onClick:I},{default:o(()=>[...r[4]||(r[4]=[x("开始压缩",-1)])]),_:1})])])):(_(),S("div",Xt,[u("div",Ht,[v.value==="processing"?(_(),R(D,{key:0})):v.value==="success"?(_(),R(z(gt),{key:1,style:{color:"var(--td-success-color)","font-size":"40px"}})):v.value==="error"?(_(),R(z(bt),{key:2,style:{color:"var(--td-error-color)","font-size":"40px"}})):E("",!0)]),u("div",Yt,V(n.value),1),l(h,{theme:"plump",percentage:a.value,status:v.value==="error"?"error":v.value==="success"?"success":"active"},null,8,["percentage","status"])]))]),_:1},8,["visible","header"])}}}),Jt=H(Zt,[["__scopeId","data-v-d36f5ae8"]]),Qt={class:"decompress-container"},es={class:"file-info"},ts={class:"value"},ss={key:0,class:"form-item"},as={key:1,class:"switch-row"},ls={key:2,class:"progress-area"},os={class:"status-header"},ns={class:"status-text"},is={class:"status-percent"},rs={key:3,class:"actions"},us=X({__name:"FileDecompress",props:{visible:{type:Boolean},instanceId:{},currentPath:{},fileName:{}},emits:["update:visible","success"],setup(U,{emit:B}){const f=U,b=B,d=q({get:()=>f.visible,set:h=>b("update:visible",h)}),v=i("auto"),a=i(!0),n=i(!1),k=i(0),F=i(""),I=i("");let m=null;const C=[{label:"自动检测 (推荐)",value:"auto"},{label:"UTF-8 (Linux/Mac通用)",value:"utf-8"},{label:"GBK (Windows传统)",value:"gbk"}],y=()=>{v.value="auto",a.value=!0,n.value=!1,k.value=0,F.value="",I.value="",m&&(clearInterval(m),m=null)};W(()=>f.visible,h=>{h&&y()});const r=()=>{m&&(clearInterval(m),m=null)},L=async()=>{if(!n.value)try{n.value=!0,F.value="正在提交任务...";const h=await lt(f.instanceId,f.fileName,f.currentPath,v.value,a.value);if(h&&h.taskId)I.value=h.taskId,m=window.setInterval(j,1e3);else throw new Error("未能获取任务ID")}catch(h){p.error(h.message||"提交失败"),n.value=!1}},j=async()=>{if(I.value)try{const h=await ot(I.value);k.value=h.progress||0,F.value=h.message,h.status==="success"?(r(),p.success("解压成功"),k.value=100,setTimeout(()=>{d.value=!1,b("success")},800)):h.status==="error"&&(r(),n.value=!1,p.error(h.message||"解压出错"))}catch(h){console.error("轮询失败",h)}},D=()=>{n.value&&k.value<100&&p.warning("解压正在后台进行中"),r(),d.value=!1};return(h,$)=>{const A=w("t-select"),Q=w("t-switch"),G=w("t-progress"),O=w("t-button"),K=w("t-dialog");return _(),R(K,{visible:d.value,"onUpdate:visible":$[2]||($[2]=M=>d.value=M),header:"解压文件",footer:!1,"close-on-overlay-click":!n.value,"on-close":D,width:"480px"},{default:o(()=>[u("div",Qt,[u("div",es,[$[3]||($[3]=u("span",{class:"label"},"目标文件：",-1)),u("span",ts,V(U.fileName),1)]),n.value?E("",!0):(_(),S("div",ss,[$[4]||($[4]=u("span",{class:"label"},"文件名编码",-1)),l(A,{modelValue:v.value,"onUpdate:modelValue":$[0]||($[0]=M=>v.value=M),options:C},null,8,["modelValue"])])),n.value?E("",!0):(_(),S("div",as,[$[5]||($[5]=u("div",{class:"switch-info"},[u("span",{class:"switch-label"},"创建同名文件夹"),u("span",{class:"switch-tip"},"推荐开启，防止文件散乱在当前目录")],-1)),l(Q,{modelValue:a.value,"onUpdate:modelValue":$[1]||($[1]=M=>a.value=M)},null,8,["modelValue"])])),n.value?(_(),S("div",ls,[u("div",os,[u("span",ns,V(F.value),1),u("span",is,V(k.value)+"%",1)]),l(G,{theme:"line",percentage:k.value,label:!1,status:k.value===100?"success":"active"},null,8,["percentage","status"])])):E("",!0),n.value?E("",!0):(_(),S("div",rs,[l(O,{variant:"outline",onClick:D},{default:o(()=>[...$[6]||($[6]=[x("取消",-1)])]),_:1}),l(O,{theme:"primary",onClick:L},{default:o(()=>[...$[7]||($[7]=[x("开始解压",-1)])]),_:1})]))])]),_:1},8,["visible","close-on-overlay-click"])}}}),cs=H(us,[["__scopeId","data-v-bec15531"]]),ds={class:"permission-form"},vs={class:"presets"},ms={class:"preset-list"},ps={key:0,class:"preset-desc"},fs={key:1,class:"preset-desc"},gs={key:2,class:"preset-desc"},bs=X({__name:"FilePermission",props:{visible:{type:Boolean},instanceId:{},currentPath:{},targets:{}},emits:["update:visible","success"],setup(U,{emit:B}){const f=U,b=B,d=i({mode:"755"}),v=i(!1),a=[{label:"755 (推荐: 所有者读写执/他人读执)",value:"755"},{label:"777 (全开: 所有权限)",value:"777"},{label:"644 (普通文件: 读写/读)",value:"644"}],n=q(()=>f.targets.length===1?`修改权限 - ${f.targets[0].name}`:`批量修改权限 (${f.targets.length} 项)`);W(()=>f.visible,m=>{m&&f.targets.length>0&&(f.targets.length===1&&f.targets[0].mode&&f.targets[0].mode!=="Unknown"?d.value.mode=f.targets[0].mode:d.value.mode="755")});const k=()=>{b("update:visible",!1),v.value=!1},F=async()=>{if(!d.value.mode||!/^[0-7]{3}$/.test(d.value.mode)){p.warning("请输入正确的3位八进制权限码 (如 755)");return}v.value=!0;let m=0,C=0;try{for(const y of f.targets)try{await nt(I,y.fullPath,d.value.mode),m++}catch(r){C++,console.error(r)}C===0?p.success("权限修改成功"):p.warning(`完成: 成功 ${m} 个, 失败 ${C} 个`),b("success"),k()}catch(y){p.error(y.message||"请求失败")}finally{v.value=!1}},I=f.instanceId;return(m,C)=>{const y=w("t-input"),r=w("t-form-item"),L=w("t-tag"),j=w("t-dialog");return _(),R(j,{visible:U.visible,header:n.value,"confirm-btn":{content:"保存修改",loading:v.value},"on-close":k,"on-confirm":F,width:"480px"},{default:o(()=>[u("div",ds,[l(r,{label:"权限代码","required-mark":""},{default:o(()=>[l(y,{modelValue:d.value.mode,"onUpdate:modelValue":C[0]||(C[0]=D=>d.value.mode=D),placeholder:"例如: 755",tips:"请输入3位八进制数字 (Linux Chmod)"},null,8,["modelValue"])]),_:1}),u("div",vs,[C[1]||(C[1]=u("div",{class:"preset-label"},"快捷设置：",-1)),u("div",ms,[(_(),S(xe,null,Ce(a,D=>l(L,{key:D.value,variant:"light-outline",theme:"primary",class:"preset-tag",style:{cursor:"pointer"},onClick:h=>d.value.mode=D.value},{default:o(()=>[x(V(D.value),1)]),_:2},1032,["onClick"])),64))]),d.value.mode==="755"?(_(),S("div",ps,"适合可执行程序、脚本或文件夹")):E("",!0),d.value.mode==="644"?(_(),S("div",fs,"适合普通配置文件、日志等")):E("",!0),d.value.mode==="777"?(_(),S("div",gs,"允许任何人写入 (不安全)")):E("",!0)])])]),_:1},8,["visible","header","confirm-btn"])}}}),hs=H(bs,[["__scopeId","data-v-34bcd43c"]]),_s={class:"file-manager-wrapper"},ys={class:"toolbar"},ws={class:"breadcrumb-area"},ks={class:"actions-area"},$s={class:"table-wrapper"},Cs=["onClick"],xs={class:"name-text"},Us={class:"op-actions"},Ps={key:0,class:"selection-bar"},Fs={class:"selection-info"},Is={class:"selection-actions"},Ds=X({__name:"index",setup(U){const B=et(),f=tt(),b=q(()=>Number(B.params.id)),d=i(!1),v=i([]),a=i(""),n=i([]),k=i(!1),F=i(!1),I=i(!1),m=i(!1),C=i(!1),y=i(!1),r=i(!1),L=i(!1),j=i(!1),D=i(""),h=i(""),$=i(""),A=i(!1),Q=i(""),G=i(""),O=i(""),K=i(""),M=i(null),ue=i([]),ce=i(""),ee=i([]),te=t=>{var c;const e=(c=t.split(".").pop())==null?void 0:c.toLowerCase();return["png","jpg","jpeg","gif","ico","webp","bmp","svg"].includes(e||"")},de=t=>{var c;const e=(c=t.split(".").pop())==null?void 0:c.toLowerCase();return["zip","jar"].includes(e||"")},ve=t=>{var c;if(t.type==="folder"){const g=t.name.toLowerCase();return g==="config"||g==="settings"?{icon:Pt,color:"var(--td-warning-color)"}:g.startsWith("world")||g==="level"?{icon:Ft,color:"var(--td-success-color)"}:["plugins","mods","libraries"].includes(g)?{icon:It,color:"var(--td-brand-color)"}:["logs","crash-reports","cache","temp"].includes(g)?{icon:we,color:"var(--td-gray-color-6)"}:{icon:we,color:"var(--td-brand-color)"}}const e=(c=t.name.split(".").pop())==null?void 0:c.toLowerCase();return["png","jpg","jpeg","gif","ico","webp"].includes(e||"")?{icon:Dt,color:"var(--td-success-color)"}:["jar","zip","rar","7z","tar","gz"].includes(e||"")?{icon:ye,color:"#722ed1"}:["yml","yaml","json","properties","toml","xml","conf","sh","bat","cmd"].includes(e||"")?{icon:Vt,color:"var(--td-warning-color)"}:["log","txt","md","lock"].includes(e||"")?{icon:St,color:"var(--td-gray-color-6)"}:{icon:zt,color:"var(--td-text-color-secondary)"}},ae=q(()=>v.value.some(t=>t.permission&&t.permission!=="")),Ue=q(()=>[{colKey:"row-select",type:"multiple",width:40},{colKey:"name",title:"文件名",ellipsis:!0,width:"auto"},{colKey:"size",title:"大小",width:100,align:"right"},...ae.value?[{colKey:"permission",title:"权限",width:80,align:"center"}]:[],{colKey:"lastModified",title:"修改时间",width:180,align:"center"},{colKey:"operation",title:"操作",width:80,align:"center"}]),Pe=q(()=>{const t=a.value.split("/").filter(g=>g),e=[{name:"根目录",path:""}];let c="";return t.forEach(g=>{c=c?`${c}/${g}`:g,e.push({name:g,path:c})}),e}),Fe=q(()=>n.value.length>0),Ie=t=>{if(t===0)return"-";const e=["B","KB","MB","GB","TB"];let c=0;for(;t>=1024&&c<e.length-1;)t/=1024,c++;return`${t.toFixed(1)} ${e[c]}`},De=t=>t?new Date(t).toLocaleString():"-",se=async()=>{d.value=!0,n.value=[];try{const t=await it(b.value,a.value);v.value=t||[]}catch(t){console.error(t)}finally{d.value=!1}},le=async t=>{G.value&&(window.URL.revokeObjectURL(G.value),G.value="");const e=a.value?`${a.value}/${t}`:t,c=p.loading("正在加载图片...");try{const g=await _e(b.value,e);if(!(g instanceof Blob))throw new Error("无效数据");G.value=window.URL.createObjectURL(g),Q.value=t,F.value=!0,p.close(c)}catch{p.close(c),p.error("加载失败")}},oe=async(t,e=!1)=>{if(e){h.value=t,$.value="",k.value=!0;return}if(te(t)){le(t);return}const c=a.value?`${a.value}/${t}`:t,g=p.loading("正在读取文件...");try{const P=await rt(b.value,c);h.value=t,$.value=P,k.value=!0,p.close(g)}catch(P){p.close(g),p.error("读取失败: "+P.message)}},Ve=()=>{O.value="",I.value=!0},me=()=>{if(!O.value.trim()){p.warning("请输入文件名");return}I.value=!1,oe(O.value,!0)},Se=async t=>{A.value=!0;try{const e=a.value?`${a.value}/${h.value}`:h.value;await vt(b.value,e,t),p.success("保存成功"),k.value=!1,T()}catch{p.error("保存失败")}finally{A.value=!1}},ze=()=>{D.value="",j.value=!0},pe=async()=>{if(!D.value.trim()){p.warning("请输入文件夹名称");return}try{await ut(b.value,a.value,D.value),p.success("文件夹创建成功"),j.value=!1,T()}catch(t){p.error(`创建失败: ${t.message||"未知错误"}`)}},Be=t=>{M.value={name:t.name,fullPath:a.value?`${a.value}/${t.name}`:t.name},K.value=t.name,m.value=!0},fe=async()=>{if(!K.value||!M.value)return;const t=a.value?`${a.value}/${K.value}`:K.value;try{await ct(b.value,M.value.fullPath,t),p.success("重命名成功"),m.value=!1,T()}catch{p.error("重命名失败")}},ge=t=>{let e=[];if(t?e=[t.name]:e=[...n.value],e.length===0)return;const c=Bt.confirm({header:"确认删除",body:`确定要永久删除这 ${e.length} 项吗？`,theme:"danger",onConfirm:async()=>{try{const g=e.map(P=>a.value?`${a.value}/${P}`:P);await dt(b.value,g),p.success("删除成功"),n.value=[],T(),c.hide()}catch{p.error("删除失败")}}})},Le=t=>{if(t.type==="folder"){const e=a.value===""?"":"/";a.value=`${a.value}${e}${t.name}`}else te(t.name)?le(t.name):oe(t.name)},Re=t=>{a.value=t},T=()=>se(),be=async t=>{var c;let e=[];if(t?e=[t.name]:e=[...n.value],e.length!==0){for(const g of e){if(((c=v.value.find(Z=>Z.name===g))==null?void 0:c.type)==="folder"){p.warning(`暂不支持下载文件夹: ${g} 请压缩后再下载！`);continue}const P=a.value?`${a.value}/${g}`:g,Y=p.loading(`准备下载: ${g}...`);try{const Z=await _e(b.value,P),ne=new Blob([Z]),N=document.createElement("a");N.href=window.URL.createObjectURL(ne),N.download=g,N.style.display="none",document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(N.href),p.close(Y)}catch{p.close(Y),p.error(`下载失败: ${g}`)}}t||(n.value=[])}},je=()=>{n.value.length!==0&&(ue.value=[...n.value],y.value=!0)},Ee=()=>{n.value=[],T()},Me=t=>{ce.value=t.name,r.value=!0},Te=()=>{T()},he=t=>{if(ee.value=[],t)ee.value.push({name:t.name,fullPath:a.value?`${a.value}/${t.name}`:t.name,mode:t.permission||"755"});else{if(n.value.length===0)return;n.value.forEach(e=>{const c=v.value.find(g=>g.name===e);c&&ee.value.push({name:c.name,fullPath:a.value?`${a.value}/${c.name}`:c.name,mode:c.permission||"755"})})}L.value=!0},Ne=()=>{n.value=[],T()},Oe=()=>T();return W(a,t=>{f.replace({query:{...B.query,path:t||void 0}}),se()}),W(b,()=>{a.value="",n.value=[],se()}),ke(()=>{const t=B.query.path;t?a.value=t:se()}),(t,e)=>{const c=w("t-breadcrumb-item"),g=w("t-breadcrumb"),P=w("t-button"),Y=w("t-dropdown"),Z=w("t-tag"),ne=w("t-table"),N=w("t-card"),ie=w("t-input"),re=w("t-dialog");return _(),S("div",_s,[l(N,{bordered:!1,class:"file-manager-card"},{default:o(()=>[u("div",ys,[u("div",ws,[l(g,{"max-item-width":"150px"},{default:o(()=>[(_(!0),S(xe,null,Ce(Pe.value,(s,J)=>(_(),R(c,{key:J,class:"crumb-item",onClick:Vs=>Re(s.path)},Ye({default:o(()=>[x(" "+V(s.name),1)]),_:2},[J===0?{name:"icon",fn:o(()=>[l(z(ht))]),key:"0"}:void 0]),1032,["onClick"]))),128))]),_:1})]),u("div",ks,[l(P,{variant:"outline",size:"medium",onClick:e[0]||(e[0]=s=>z(pt)(`/instance/console/${b.value}`))},{icon:o(()=>[l(z(_t))]),default:o(()=>[e[20]||(e[20]=x("返回控制台 ",-1))]),_:1}),l(Y,{options:[{content:"新建文件",value:"file",onClick:Ve},{content:"新建文件夹",value:"folder",onClick:ze}]},{default:o(()=>[l(P,{variant:"outline",size:"medium"},{icon:o(()=>[l(z(yt))]),default:o(()=>[e[21]||(e[21]=x("新建 ",-1))]),_:1})]),_:1},8,["options"]),l(P,{theme:"primary",size:"medium",onClick:e[1]||(e[1]=s=>C.value=!0)},{icon:o(()=>[l(z(wt))]),default:o(()=>[e[22]||(e[22]=x("上传文件 ",-1))]),_:1}),l(P,{variant:"outline",size:"medium",onClick:T},{icon:o(()=>[l(z(kt))]),_:1})])]),u("div",$s,[l(ne,{"selected-row-keys":n.value,"onUpdate:selectedRowKeys":e[2]||(e[2]=s=>n.value=s),data:v.value,columns:Ue.value,"row-key":"name",loading:d.value,hover:!0,size:"medium",class:"file-table"},{name:o(({row:s})=>[u("div",{class:"file-name-cell",onClick:Ze(J=>Le(s),["stop"])},[(_(),R(Je(ve(s).icon),{class:"file-icon",style:Qe({color:ve(s).color})},null,8,["style"])),u("span",xs,V(s.name),1)],8,Cs)]),size:o(({row:s})=>[x(V(Ie(s.size)),1)]),permission:o(({row:s})=>[s.permission?(_(),R(Z,{key:0,variant:"light",size:"small"},{default:o(()=>[x(V(s.permission),1)]),_:2},1024)):E("",!0)]),lastModified:o(({row:s})=>[x(V(De(s.lastModified)),1)]),operation:o(({row:s})=>[u("div",Us,[l(Y,{options:[{content:"解压",value:"decompress",onClick:()=>Me(s),show:de(s.name)&&s.type!=="folder"},{content:te(s.name)?"预览":"编辑",value:"edit",onClick:()=>te(s.name)?le(s.name):oe(s.name),disabled:s.type==="folder"||de(s.name)},{content:"权限",value:"permission",onClick:()=>he(s),show:ae.value},{content:"下载",value:"download",onClick:()=>be(s)},{content:"重命名",value:"rename",onClick:()=>Be(s)},{content:"删除",value:"delete",theme:"error",onClick:()=>ge(s)}].filter(J=>J.show!==!1)},{default:o(()=>[l(P,{variant:"text",shape:"square"},{default:o(()=>[l(z($t))]),_:1})]),_:1},8,["options"])])]),empty:o(()=>[...e[23]||(e[23]=[u("div",{class:"empty-state"},"暂无文件",-1)])]),_:1},8,["selected-row-keys","data","columns","loading"])])]),_:1}),l(He,{name:"slide-up"},{default:o(()=>[Fe.value?(_(),S("div",Ps,[u("div",Fs,[e[24]||(e[24]=x(" 已选 ",-1)),u("span",null,V(n.value.length),1),e[25]||(e[25]=x(" 项 ",-1))]),u("div",Is,[l(P,{size:"small",variant:"text",theme:"primary",onClick:e[3]||(e[3]=s=>je())},{icon:o(()=>[l(z(ye))]),default:o(()=>[e[26]||(e[26]=x("压缩 ",-1))]),_:1}),l(P,{size:"small",variant:"text",theme:"primary",onClick:e[4]||(e[4]=s=>be())},{icon:o(()=>[l(z(Ct))]),default:o(()=>[e[27]||(e[27]=x("下载 ",-1))]),_:1}),ae.value?(_(),R(P,{key:0,size:"small",variant:"text",theme:"primary",onClick:e[5]||(e[5]=s=>he())},{icon:o(()=>[l(z(xt))]),default:o(()=>[e[28]||(e[28]=x("权限 ",-1))]),_:1})):E("",!0),l(P,{size:"small",variant:"text",theme:"danger",onClick:e[6]||(e[6]=s=>ge())},{icon:o(()=>[l(z(Ut))]),default:o(()=>[e[29]||(e[29]=x("删除 ",-1))]),_:1}),l(P,{size:"small",variant:"text",onClick:e[7]||(e[7]=s=>n.value=[])},{default:o(()=>[...e[30]||(e[30]=[x("取消",-1)])]),_:1})])])):E("",!0)]),_:1}),l(Mt,{visible:k.value,"onUpdate:visible":e[8]||(e[8]=s=>k.value=s),"file-name":h.value,content:$.value,loading:A.value,onSave:Se},null,8,["visible","file-name","content","loading"]),l(re,{visible:I.value,"onUpdate:visible":e[10]||(e[10]=s=>I.value=s),header:"新建文件","on-confirm":me},{default:o(()=>[l(ie,{modelValue:O.value,"onUpdate:modelValue":e[9]||(e[9]=s=>O.value=s),placeholder:"输入文件名",autofocus:!0,onEnter:me},null,8,["modelValue"])]),_:1},8,["visible"]),l(re,{visible:m.value,"onUpdate:visible":e[12]||(e[12]=s=>m.value=s),header:"重命名","on-confirm":fe},{default:o(()=>[l(ie,{modelValue:K.value,"onUpdate:modelValue":e[11]||(e[11]=s=>K.value=s),placeholder:"输入新名称",autofocus:!0,onEnter:fe},null,8,["modelValue"])]),_:1},8,["visible"]),l(ft,{visible:C.value,"onUpdate:visible":e[13]||(e[13]=s=>C.value=s),"instance-id":b.value,"current-path":a.value,onSuccess:Oe},null,8,["visible","instance-id","current-path"]),l(qt,{visible:F.value,"onUpdate:visible":e[14]||(e[14]=s=>F.value=s),"file-name":Q.value,"image-blob-url":G.value},null,8,["visible","file-name","image-blob-url"]),l(Jt,{visible:y.value,"onUpdate:visible":e[15]||(e[15]=s=>y.value=s),"instance-id":b.value,"current-path":a.value,files:ue.value,onSuccess:Ee},null,8,["visible","instance-id","current-path","files"]),l(cs,{visible:r.value,"onUpdate:visible":e[16]||(e[16]=s=>r.value=s),"instance-id":b.value,"current-path":a.value,"file-name":ce.value,onSuccess:Te},null,8,["visible","instance-id","current-path","file-name"]),l(hs,{visible:L.value,"onUpdate:visible":e[17]||(e[17]=s=>L.value=s),"instance-id":b.value,"current-path":a.value,targets:ee.value,onSuccess:Ne},null,8,["visible","instance-id","current-path","targets"]),l(re,{visible:j.value,"onUpdate:visible":e[19]||(e[19]=s=>j.value=s),header:"新建文件夹","on-confirm":pe},{default:o(()=>[l(ie,{modelValue:D.value,"onUpdate:modelValue":e[18]||(e[18]=s=>D.value=s),placeholder:"输入文件夹名称",autofocus:!0,onEnter:pe},null,8,["modelValue"])]),_:1},8,["visible"])])}}}),$a=H(Ds,[["__scopeId","data-v-695992f4"]]);export{$a as default};
