import{u as C,r as P,_ as T,d as I,c as q}from"./index.Dh86awbc.js";import{I as f,C as M,T as z,a as H,L as J}from"./tdesign-vue-next.DWJvSscW.js";import{D as k,F as h,R as V,b1 as w,aY as g,b2 as c,a$ as t,ap as e,G as o,ao as U,b5 as d,W as K,V as W,aa as X,b0 as $,aX as E,bb as Y,bc as j,P as Q,K as Z,b6 as tt}from"./index.BbdIPky0.js";import{u as et}from"./instance.Yptueto-.js";import{i as N}from"./echarts.J8iroDPP.js";import{V as st}from"./zrender.B_NAtvFA.js";import{r as ot}from"./md-editor-v3.DExjSZcL.js";import"./pinia.DE9DXmFR.js";import"./pinia-plugin-persistedstate.n2tMOXAx.js";import"./vue-router.CTuarHf7.js";import"./tvision-color.BU_YHHaJ.js";import"./chroma-js.Cmk4elvR.js";import"./bezier-easing.jp9ayU57.js";import"./lodash.B5_zCkFd.js";import"./axios.R-lXtGyY.js";import"./qs.CnepGyXr.js";import"./side-channel.Bf-JVZLg.js";import"./es-errors.CFxpeikN.js";import"./object-inspect.CD-SYzlK.js";import"./cron-parser.BqMfRICj.js";import"./luxon.BVaPVz1w.js";import"./side-channel-list.CQN2BsdT.js";import"./side-channel-map.BJ69Knz3.js";import"./get-intrinsic.CAdfHqt8.js";import"./es-object-atoms.Ditt1eQ6.js";import"./math-intrinsics.Cv-yPkyD.js";import"./gopd.fcd2-aIC.js";import"./es-define-property.bDCdrV83.js";import"./has-symbols.BaUvM3gb.js";import"./get-proto.Cbri-GHQ.js";import"./dunder-proto.q7lw_6_J.js";import"./call-bind-apply-helpers.BxcZtPLH.js";import"./function-bind.BbkWVFrm.js";import"./hasown.ckq0ukzO.js";import"./call-bound.BO70H6sD.js";import"./side-channel-weakmap.BkoVKe_V.js";import"./nprogress.CMq2Rk2a.js";import"./core-js-pure.DghWRT_o.js";import"./crelt.C8TCjufn.js";import"./style-mod.Bc2inJdb.js";import"./w3c-keyname.Vcq4gwWv.js";import"./lodash-es.ClUTdtmA.js";import"./tdesign-icons-vue-next.Q06Erwsy.js";import"./mitt.DJ65BbbF.js";import"./sortablejs.C83syoBY.js";import"./tslib.BDyQ-Jie.js";import"./markdown-it.Baj76ayU.js";import"./mdurl.k9Sl0PQj.js";import"./uc.micro.kMc2yuuw.js";import"./entities.C20TfXL6.js";import"./linkify-it.DWYhiEiT.js";import"./punycode.js.Dj65hjkv.js";import"./markdown-it-image-figures.IpqUZCLv.js";import"./markdown-it-sub.Bxi31R0z.js";import"./markdown-it-sup.Bp2DoVCN.js";import"./lru-cache.DJEINSmt.js";import"./medium-zoom.bWEtUbjf.js";const nt={class:"welcome-header"},at={class:"avatar-section"},it=["src"],rt={class:"welcome-info"},lt={class:"welcome-text"},ct={class:"hitokoto-text"},mt=k({__name:"Banner",setup(S){const a=C(),n=h("");async function u(){const s=`Every little creature in the world has their own piece of paradise.
Plants take root in the boundless earth, and their leaves grow toward the stars.`;try{const l=await P.get({url:"/?c=a&c=b&c=c&c=d",baseURL:"https://v1.hitokoto.cn"});l&&l.hitokoto?n.value=`${l.hitokoto} â€”â€” ã€Š${l.from}ã€‹${l.from_who?` (${l.from_who})`:""}`:n.value=s}catch(l){n.value=s,console.error("è·å–ä¸€è¨€(Hitokoto)å¤±è´¥:",l)}}return V(()=>{u()}),(s,l)=>(g(),w(e(M),{shadow:"",bordered:!1,class:"welcome-card"},{default:c(()=>[t("div",nt,[t("div",at,[t("img",{src:e(a).userInfo.avatar,alt:"å¤´åƒ",class:"user-avatar"},null,8,it)]),t("div",rt,[t("h3",lt,[o(e(f),{name:"sunny",class:"welcome-icon"}),U(" ä½ å¥½, "+d(e(a).userInfo.name),1)]),t("p",ct,d(n.value),1)])])]),_:1}))}}),dt=T(mt,[["__scopeId","data-v-bccd23b1"]]),ut={class:"info-grid"},pt={class:"info-item"},_t={class:"info-label"},ft={class:"info-value"},vt={class:"info-item"},ht={class:"info-label"},gt={class:"info-value"},yt={class:"info-item"},bt={class:"info-label"},wt={class:"info-value truncate-value"},xt={class:"info-item"},$t={class:"info-label"},kt={class:"info-value truncate-value"},St={class:"info-item"},It={class:"info-label"},Ut={class:"info-value truncate-value"},Ct={class:"info-item"},Tt={class:"info-label"},Vt={class:"info-value"},Lt={class:"info-item"},Rt={class:"info-label"},zt={class:"info-value truncate-value"},Mt={class:"info-item"},At={class:"info-label"},Bt={class:"info-value"},Dt=k({__name:"InfoCard",setup(S){const a=C(),n=et();return V(()=>{n.refreshInstanceList()}),(u,s)=>(g(),w(e(M),{shadow:"",bordered:!1,class:"system-info-card"},{default:c(()=>[t("div",ut,[t("div",pt,[t("span",_t,[o(e(f),{name:"server"}),s[0]||(s[0]=t("span",null,"åœ¨çº¿å®ä¾‹ï¼š",-1))]),t("span",ft,d(e(n).onlineInstanceCount)+" / "+d(e(n).totalInstanceCount),1)]),t("div",vt,[t("span",ht,[o(e(f),{name:"logo-codepen"}),s[1]||(s[1]=t("span",null,"NETç¯å¢ƒï¼š",-1))]),t("span",gt,d(e(a).userInfo.systemInfo.netVersion),1)]),t("div",yt,[t("span",bt,[o(e(f),{name:"dashboard"}),s[2]||(s[2]=t("span",null,"é¢æ¿ç‰ˆæœ¬ï¼š",-1))]),o(e(z),{content:e(I).version,"max-width":"400px"},{default:c(()=>[t("span",wt,d(e(I).version),1)]),_:1},8,["content"])]),t("div",xt,[t("span",$t,[o(e(f),{name:"cloud"}),s[3]||(s[3]=t("span",null,"èŠ‚ç‚¹ç‰ˆæœ¬ï¼š",-1))]),o(e(z),{content:`v${e(a).userInfo.version}`,"max-width":"400px"},{default:c(()=>[t("span",kt," v"+d(e(a).userInfo.version),1)]),_:1},8,["content"])]),t("div",St,[t("span",It,[o(e(f),{name:"desktop"}),s[4]||(s[4]=t("span",null,"ä¸»æœºåï¼š",-1))]),t("span",Ut,d(e(a).userInfo.systemInfo.hostname),1)]),t("div",Ct,[t("span",Tt,[o(e(f),{name:"system-code"}),s[5]||(s[5]=t("span",null,"ç³»ç»Ÿç±»å‹ï¼š",-1))]),t("span",Vt,d(e(a).userInfo.systemInfo.osType)+" ("+d(e(a).userInfo.systemInfo.osArchitecture)+")",1)]),t("div",Lt,[t("span",Rt,[o(e(f),{name:"system-setting"}),s[6]||(s[6]=t("span",null,"ç³»ç»Ÿç‰ˆæœ¬ï¼š",-1))]),o(e(z),{content:e(a).userInfo.systemInfo.osVersion,"max-width":"400px"},{default:c(()=>[t("span",zt,d(e(a).userInfo.systemInfo.osVersion),1)]),_:1},8,["content"])]),t("div",Mt,[t("span",At,[o(e(f),{name:"check-circle"}),s[7]||(s[7]=t("span",null,"ç‰ˆæœ¬åŒ¹é…ï¼š",-1))]),t("span",Bt,[o(e(H),{theme:e(a).userInfo.targetFrontendVersion.panel===e(I).version?"success":"danger",variant:"light"},{default:c(()=>[U(d(e(a).userInfo.targetFrontendVersion.panel===e(I).version?"æ­£ç¡®åŒ¹é…":"è¯·æ›´æ–°"),1)]),_:1},8,["theme"])])])])]),_:1}))}}),Nt=T(Dt,[["__scopeId","data-v-782b0c4a"]]),Pt={class:"monitor-dashboard"},Et={class:"card-content"},Ft={class:"info-section"},Ot={class:"value-group"},Gt={class:"value"},qt={class:"card-content"},Ht={class:"info-section"},Jt={class:"value-group"},Kt={class:"value"},Wt={class:"sub-text"},Xt=30,Yt=k({__name:"SystemStatus",setup(S){const a=C(),n=h(null),u=h(!1),s=h(null),l=h(null);let m=null,r=null;const v=K({cpu:0,memUsage:0,memUsed:0,memTotal:0}),b=[],L=[],R=[],A=_=>getComputedStyle(document.documentElement).getPropertyValue(_).trim()||"#999999",B=(_,i,y)=>({grid:{top:10,right:10,bottom:0,left:0,containLabel:!1},tooltip:{trigger:"axis",backgroundColor:"var(--td-bg-color-container)",borderColor:"var(--td-component-border)",textStyle:{color:"var(--td-text-color-primary)"},formatter:p=>{const x=p[0];return`${x.name}<br/><span style="color:${_}">â—</span> ${i}: <b>${x.value}%</b>`}},xAxis:{type:"category",boundaryGap:!1,data:b,show:!1},yAxis:{type:"value",max:100,min:0,show:!1},series:[{name:i,type:"line",smooth:!0,showSymbol:!1,lineStyle:{width:2,color:_},areaStyle:{opacity:.2,color:new st(0,0,0,1,[{offset:0,color:_},{offset:1,color:"transparent"}])},data:y}]}),F=()=>{const _=A("--td-brand-color"),i=A("--td-success-color");s.value&&(m=N(s.value),m.setOption(B(_,"CPU",[]))),l.value&&(r=N(l.value),r.setOption(B(i,"Memory",[]))),window.addEventListener("resize",D)},D=()=>{m==null||m.resize(),r==null||r.resize()},O=async()=>{const{baseUrl:_,token:i}=a,y=new URL("/api/hubs/system",_||window.location.origin);i&&y.searchParams.append("x-user-token",i),n.value=new Y().withUrl(y.toString(),{withCredentials:!1}).withAutomaticReconnect().build(),n.value.on("ReceiveSystemStats",p=>{v.cpu=p.cpu,v.memUsage=p.memUsage,v.memUsed=p.memUsed,v.memTotal=p.memTotal,b.length>=Xt&&(b.shift(),L.shift(),R.shift()),b.push(p.timestamp),L.push(p.cpu),R.push(p.memUsage),m==null||m.setOption({xAxis:{data:b},series:[{data:L}]}),r==null||r.setOption({xAxis:{data:b},series:[{data:R}]})});try{await n.value.start(),u.value=!0,await n.value.invoke("JoinMonitor")}catch(p){console.error("SignalR è¿æ¥å¤±è´¥:",p)}n.value.onclose(()=>{u.value=!1})};return V(()=>{W(()=>{setTimeout(()=>{F(),O()},100)})}),X(async()=>{if(window.removeEventListener("resize",D),n.value)try{await n.value.invoke("LeaveMonitor"),await n.value.stop()}catch(_){console.error(_)}m==null||m.dispose(),r==null||r.dispose()}),(_,i)=>{const y=$("t-tag"),p=$("t-card"),x=$("t-col"),G=$("t-row");return g(),E("div",Pt,[o(G,{gutter:[12,12]},{default:c(()=>[o(x,{xs:12,md:6},{default:c(()=>[o(p,{shadow:"",bordered:!1,class:"chart-card",size:"small"},{default:c(()=>[t("div",Et,[t("div",Ft,[i[3]||(i[3]=t("div",{class:"label"},"CPU ä½¿ç”¨ç‡",-1)),t("div",Ot,[t("span",Gt,d(v.cpu),1),i[0]||(i[0]=t("span",{class:"unit"},"%",-1))]),u.value?(g(),w(y,{key:0,theme:"success",variant:"light",size:"small",class:"status-tag"},{default:c(()=>[...i[1]||(i[1]=[U(" å®æ—¶ ",-1)])]),_:1})):(g(),w(y,{key:1,theme:"danger",variant:"light",size:"small",class:"status-tag"},{default:c(()=>[...i[2]||(i[2]=[U(" ç¦»çº¿ ",-1)])]),_:1}))]),t("div",{ref_key:"cpuChartRef",ref:s,class:"chart-container"},null,512)])]),_:1})]),_:1}),o(x,{xs:12,md:6},{default:c(()=>[o(p,{shadow:"",bordered:!1,class:"chart-card",size:"small"},{default:c(()=>[t("div",qt,[t("div",Ht,[i[5]||(i[5]=t("div",{class:"label"},"å†…å­˜ä½¿ç”¨ç‡",-1)),t("div",Jt,[t("span",Kt,d(v.memUsage),1),i[4]||(i[4]=t("span",{class:"unit"},"%",-1))]),t("div",Wt,d((v.memUsed/1024).toFixed(1))+" / "+d((v.memTotal/1024).toFixed(1))+" GB ",1)]),t("div",{ref_key:"memChartRef",ref:l,class:"chart-container"},null,512)])]),_:1})]),_:1})]),_:1})])}}}),jt=T(Yt,[["__scopeId","data-v-1ffcce97"]]),Qt={class:"card-header"},Zt={class:"announcement-wrapper"},te=k({__name:"Announcement",setup(S){const a=h(!0),n=h(""),u=j(),s=h(u.value?"dark":"light");Q(u,()=>{s.value=u.value?"dark":"light"});async function l(){a.value=!0;const m=`## ğŸ”´ å…¬å‘ŠåŠ è½½å¤±è´¥
- è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è”ç³»ç®¡ç†å‘˜ã€‚`;try{const r=await P.get({url:"https://api.mslmc.cn/v3/query/notice?query=mslxNoticeMd"});r&&r.mslxNoticeMd?n.value=r.mslxNoticeMd:n.value=m}catch(r){console.error("è·å–å…¬å‘Šå¤±è´¥:",r),n.value=m}finally{a.value=!1}}return V(()=>{l()}),(m,r)=>(g(),w(e(M),{shadow:"",bordered:!1,class:"announcement-card"},{title:c(()=>[t("div",Qt,[o(e(f),{name:"system-messages"}),r[0]||(r[0]=t("span",null,"ç³»ç»Ÿå…¬å‘Š",-1))])]),default:c(()=>[o(e(J),{loading:a.value,text:"åŠ è½½ä¸­...",size:"small",style:{width:"100%"}},{default:c(()=>[t("div",Zt,[o(e(ot),{"editor-id":"announcement-preview","model-value":n.value,theme:s.value,class:"md-preview-wrapper"},null,8,["model-value","theme"])])]),_:1},8,["loading"])]),_:1}))}}),ee=T(te,[["__scopeId","data-v-b7aa6442"]]),as=k({__name:"index",setup(S){const a=C(),n=Z(()=>{var u;return((u=a.userInfo)==null?void 0:u.username)==="mslx"});return(u,s)=>{const l=$("t-alert");return g(),E("div",null,[n.value?(g(),w(l,{key:0,theme:"warning",title:"å®‰å…¨é£é™©æç¤º",message:"æ£€æµ‹åˆ°æ‚¨å½“å‰æ­£åœ¨ä½¿ç”¨é»˜è®¤è´¦å· (mslx)ã€‚ä¸ºäº†ä¿éšœç³»ç»Ÿå®‰å…¨ï¼Œè¯·åŠ¡å¿…å°½å¿«ä¿®æ”¹ç”¨æˆ·åå’Œå¯†ç ï¼",style:{"margin-bottom":"16px"}},{operation:c(()=>[t("span",{style:{cursor:"pointer"},onClick:s[0]||(s[0]=m=>e(q)("/settings"))},"å»ä¿®æ”¹")]),_:1})):tt("",!0),o(dt),o(Nt,{style:{"margin-top":"12px"}}),o(jt,{style:{"margin-top":"12px"}}),o(ee,{style:{"margin-top":"12px"}})])}}});export{as as default};
