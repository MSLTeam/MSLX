<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:suki="clr-namespace:SukiUI.Controls;assembly=SukiUI"
             xmlns:micon="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
             xmlns:models="clr-namespace:MSLX.Desktop.Models"
			 xmlns:ic="clr-namespace:MSLX.Desktop.Converters"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="MSLX.Desktop.Views.InstanceListPage">
	<suki:GlassCard Margin="10">
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>
			<StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="15">
				<TextBlock Classes="h3" Text="实例列表"/>
				<Button x:Name="RefreshBtn" Click="RefreshBtn_Click" VerticalAlignment="Center">
					<micon:MaterialIcon Kind="Refresh"/>
				</Button>
				<Button x:Name="CreateInstance" Click="CreateInstance_Click" VerticalAlignment="Center">
					<micon:MaterialIcon Kind="Add"/>
				</Button>
			</StackPanel>
			
			<ScrollViewer Grid.Row="1">
				<ItemsControl ItemsSource="{Binding Source={x:Static models:InstanceModel.Model}, Path=ServerList}">
					<ItemsControl.ItemTemplate>
						<DataTemplate DataType="models:InstanceModel+InstanceInfo" >
							<suki:GlassCard Margin="5">
								<Grid ColumnDefinitions="auto,*,auto">
									<Image Height="64" Margin="0,0,10,0" Source="avares://MSLX-Desktop/Assets/icon.ico"/>
									<StackPanel Grid.Column="1" Spacing="5">
										<StackPanel Orientation="Horizontal">
											<TextBlock FontSize="18" FontWeight="Bold">
												<Run Text="#"/><Run Text="{Binding ID}"/>
												<Run Text=" "/>
												<Run Text="{Binding Name}"/>
											</TextBlock>
											<Border CornerRadius="6"
													Padding="8,2"
													Margin="15,3,0,0"
													VerticalAlignment="Center">
												<Border.Background>
													<MultiBinding Converter="{x:Static ic:StatusToBrushConverter.Instance}">
														<Binding Path="Status"/>
													</MultiBinding>
												</Border.Background>

												<TextBlock Text="{Binding StatusText}"
														   FontSize="12"
														   Foreground="White"
														   FontWeight="Bold"/>
											</Border>
										</StackPanel>
										<StackPanel Orientation="Horizontal">
											<TextBlock Text="目录："/>
											<TextBlock Text="{Binding Base}"/>
										</StackPanel>
										<StackPanel Orientation="Horizontal">
											<TextBlock Text="核心："/>
											<TextBlock Text="{Binding Core, Converter={x:Static ic:CoreNameConverter.Instance}}"/>
										</StackPanel>
									</StackPanel>
									<Grid Grid.Column="2" Margin="10,0,0,0" VerticalAlignment="Center">
										<Grid.RowDefinitions>
											<RowDefinition Height="Auto"/>
											<RowDefinition Height="Auto"/>
										</Grid.RowDefinitions>
										<Grid>
											<Grid.ColumnDefinitions>
												<ColumnDefinition Width="*"/>
												<ColumnDefinition Width="Auto"/>
											</Grid.ColumnDefinitions>
											<Button Classes="Flat"
													Padding="12,0,12,0"
													Click="RunServerButton_Click"
													Tag="{Binding ID}">
												<StackPanel Orientation="Horizontal">
													<micon:MaterialIcon Kind="Play"/>
													<TextBlock Text="运行"/>
												</StackPanel>
											</Button>
											<Button Grid.Column="1"
													Margin="5,0,0,0"
													Click="SettingsButton_Click"
													Tag="{Binding ID}">
												<micon:MaterialIcon Foreground="{DynamicResource SukiPrimaryColor}" Kind="Settings"/>
											</Button>
										</Grid>
										<Grid Grid.Row="1" Margin="0,5,0,0">
											<Grid.ColumnDefinitions>
												<ColumnDefinition Width="*"/>
												<ColumnDefinition Width="Auto"/>
											</Grid.ColumnDefinitions>
											<Button Padding="12,0,12,0"
													Click="OpenFolderButton_Click"
													Tag="{Binding ID}">
												<StackPanel Orientation="Horizontal">
													<micon:MaterialIcon Foreground="{DynamicResource SukiPrimaryColor}" Kind="FolderOutline"/>
													<TextBlock Margin="3,0,0,0" Text="打开文件夹"/>
												</StackPanel>
											</Button>
											<Button Grid.Column="1"
													Margin="5,0,0,0"
													Click="DeleteServerButton_Click" Classes="Accent"
													Tag="{Binding ID}">
												<micon:MaterialIcon Foreground="{DynamicResource SukiWarningColor}" Kind="Delete"/>
											</Button>
										</Grid>
									</Grid>
									
								</Grid>
							</suki:GlassCard>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
					<ItemsControl.ItemsPanel>
						<ItemsPanelTemplate>
							<VirtualizingStackPanel />
						</ItemsPanelTemplate>
					</ItemsControl.ItemsPanel>
				</ItemsControl>
			</ScrollViewer>
			<StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Bottom" HorizontalAlignment="Right" Spacing="5">
				
			</StackPanel>
		</Grid>
	</suki:GlassCard>
</UserControl>
